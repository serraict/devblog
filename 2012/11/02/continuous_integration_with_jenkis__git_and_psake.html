<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="My blog">
        <meta name="viewport" content="width=device-width">
        <title>Continuous Integration with Jenkins, git and psake &mdash; Serra&#39;s Blog ^^</title>
            <link rel="stylesheet" href="../../../_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/main.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/modern5.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="../../../_static/font-awesome.min.css" type="text/css">
        <link rel="stylesheet" href="../../../_static/serra.css" type="text/css" /><link rel="shortcut icon" href="../../../_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="../../../_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../../../_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="../../../_static/plugins.js"></script>
        <script src="../../../_static/main.js"></script>
        <link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Adding a persistent event store" href="../../08/01/adding_mongodb_event_store.html" /><link rel="prev" title="My Readings …" href="../../12/10/my_books.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="../../../_static/underscore.js"></script><script type="text/javascript" src="../../../_static/doctools.js"></script><script type="text/javascript" src="../../../_static/disqus.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Adjusts document height if sidebar is taller
            var documentwrapper = document.getElementsByTagName("article")[0];
            var sidebar = document.getElementsByClassName("sidebar")[0];

            if (sidebar.offsetHeight > documentwrapper.offsetHeight)
            {
                var mainwrapper = document.getElementsByClassName("main")[0];
                documentwrapper.style.minHeight = mainwrapper.offsetHeight + "px";
            }

            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header role="banner">
            <hgroup>
              <h1><a href="../../../index.html">Serra&#39;s Blog ^^</a></h1><h2>Learning while developing software</h2></hgroup>
          </header>
      <nav role="navigation">
            <ul><li class="quicklink"><div class="rss">
        <a href="../../../rss.html" title="Subscribe via RSS"><span class="fa fa-lg fa-rss"></span></a>
    </div></li><li class="main-nav">
                  <a href="../../../index.html">Home</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/bio.html">Bio</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/contact.html">Contact</a>
                </li>
              </ul>
          </nav><div class="main-container" role="main"><div class="main wrapper body clearfix"><article role="article"><ul class="related clearfix">
            <li class="left"> &laquo; <a href="../../12/10/my_books.html">My Readings …</a></li>
            <li class="right"><a href="../../08/01/adding_mongodb_event_store.html">Adding a persistent event store</a> &raquo; </li>
        </ul><div class="timestamp postmeta">
            <span>November 02, 2012</span>
        </div>
    <div class="section" id="continuous-integration-with-jenkins-git-and-psake">
<h1>Continuous Integration with Jenkins, git and psake</h1>
<p>Right now, I’m using a Continuous Integration (CI) setup consisting of:</p>
<blockquote>
<div><ul class="simple">
<li>A Jenkins CI server, running on a Rackspace Ubuntu 12.04 server</li>
<li>git source control, backed by a github project</li>
<li>.net projects, with psake build scripts</li>
<li>Windows 7 build machine</li>
</ul>
</div></blockquote>
<p>Here are a few take-aways:</p>
<div id="more"> </div><div class="section" id="windows-slave">
<h2>Windows slave</h2>
<blockquote>
<div><ul class="simple">
<li>Use labels to identify a build machine as a Windows machine.</li>
<li>Since my build machine isn’t accessible from the Internet,
I used Java Web start to get started and install
it as Windows service from the UI <a class="footnote-reference" href="#javawebstart" id="id1">[7]</a>.
Note you might want to run the <a href="#id2"><span class="problematic" id="id3">`</span></a>javaws … `
from a command prompt with elevated privileges
to be able to install a Windows Service.</li>
<li>I configured the Jenkins Slave service to log on as
dedicated user on the build machine that has all the build paths
and ssh keys set up to work with my bot account on Github <a class="footnote-reference" href="#serra-bot" id="id4">[8]</a></li>
<li>Don’t forget that your slave has to give consent to restore missing
using NuGet <a class="footnote-reference" href="#nuget-consent" id="id5">[9]</a>; id did this by setting the
<cite>EnableNuGetPackageRestore</cite> environment variable to <cite>true</cite>.</li>
<li>Install the Windows (7/8/…) SDK</li>
<li>You might need to copy some build targets from
<cite>C:Program Files (x86)MSBuildMicrosoftVisualStudio</cite>,
or alternatively install Visual Studio on your build server
(now WHO would want to do THAT?).</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="git-github">
<h2>git &amp; Github</h2>
<blockquote>
<div><ul>
<li><p class="first">Authenticate using https,
make sure you can connect WITHOUT entering credentials.
I did this using gitextensions,
which stores the credentials in the Windows credential cache.</p>
</li>
<li><p class="first">Or install using SSH:</p>
<blockquote>
<div><ul class="simple">
<li>On your build slave, set up an ssh key pair that doesn’t require a pass phrase.</li>
<li>The first time, connect manually from the command line <a class="footnote-reference" href="#github-ssh" id="id6">[5]</a>.</li>
<li>Run the slave service as a user that has a ssh key pair setup for the git repo.</li>
<li>Check from a command window that your git client is properly set up.
You should be able to do <cite>ssh -T git&#64;github.com</cite> and
<cite>git clone git&#64;github.com:&lt;user&gt;/&lt;repo&gt;.git</cite>
without any additional key strokes.</li>
<li>When setting up your Windows slave, you might find Thomas’ blog post
<a class="footnote-reference" href="#vandoren" id="id7">[6]</a> useful.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="psake">
<h2>psake</h2>
<blockquote>
<div><ul class="simple">
<li>Don’t forget to set the PS execution policy to <cite>RemoteSigned</cite>
on your build slave.</li>
<li>When using the Jenkins PS plugin,
use the <cite>psake.ps1</cite> helper script with <cite>$psake.use_exit_on_error = $true</cite>
<a class="footnote-reference" href="#psake-jenkins-integration" id="id8">[1]</a>.
This to make sure the build script exits with an exit code not equal to 0
in the case of build errors.
I didn’t get this to work; not sure why. So …</li>
<li>Instead of using the Jenkins PowerShell[#PSPLugin]_ plugin for executing
psake build scripts, I used the <cite>psake.cmd</cite> deployed with psake.
By default, <cite>psake.cmd</cite> bypasses the execution policy,
so you might not want to do this.</li>
</ul>
</div></blockquote>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="psake-jenkins-integration" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[1]</a></td><td><a class="reference external" href="https://github.com/psake/psake/wiki/How-can-I-integrate-psake-with-Hudson%3F">https://github.com/psake/psake/wiki/How-can-I-integrate-psake-with-Hudson%3F</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="psake-using-ps-plugin" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><a class="reference external" href="http://matosjorge2013.wordpress.com/2010/07/27/how-to-integrate-psake-with-hudson/">http://matosjorge2013.wordpress.com/2010/07/27/how-to-integrate-psake-with-hudson/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><a class="reference external" href="https://github.com/psake/psake/wiki">https://github.com/psake/psake/wiki</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="psplugin" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td><a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/PowerShell+Plugin">https://wiki.jenkins-ci.org/display/JENKINS/PowerShell+Plugin</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="github-ssh" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td><a class="reference external" href="https://help.github.com/articles/generating-ssh-keys">https://help.github.com/articles/generating-ssh-keys</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="vandoren" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[6]</a></td><td><a class="reference external" href="http://blog.thomasvandoren.com/2011/09/jenkins-windows-slave-with-git/">http://blog.thomasvandoren.com/2011/09/jenkins-windows-slave-with-git/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="javawebstart" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[7]</a></td><td><a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds#Distributedbuilds-LaunchslaveagentviaJavaWebStart">https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds#Distributedbuilds-LaunchslaveagentviaJavaWebStart</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="serra-bot" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[8]</a></td><td><a class="reference external" href="https://github.com/serra-bot">https://github.com/serra-bot</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="nuget-consent" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[9]</a></td><td><a class="reference external" href="http://blog.nuget.org/20120518/package-restore-and-consent.html">http://blog.nuget.org/20120518/package-restore-and-consent.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="onehour-guide" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[10]</td><td><a class="reference external" href="http://ferritedog.wordpress.com/2011/05/27/1-hour-guide-to-continuous-integration-setup-jenkins-meets-net/">http://ferritedog.wordpress.com/2011/05/27/1-hour-guide-to-continuous-integration-setup-jenkins-meets-net/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="nunit-plugin" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[11]</td><td><a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/NUnit+Plugin">https://wiki.jenkins-ci.org/display/JENKINS/NUnit+Plugin</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="xunit-plugin" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[12]</td><td><a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin">https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="htmlpublisher-plugin" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[13]</td><td><a class="reference external" href="https://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin">https://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin</a></td></tr>
</tbody>
</table>
</div>
</div>

    <div class="postmeta">
        <div class="author">
            <span>Posted by Marijn van der Zee</span>
        </div>
        
        
        </div>
    <div id="disqus_thread"></div><script type="text/javascript">    var disqus_shortname = "serraongithub";    var disqus_identifier = "2012/11/02/continuous_integration_with_jenkis__git_and_psake";    disqus_thread();</script><noscript>Please enable JavaScript to view the    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><ul class="related clearfix">
            <li class="left"> &laquo; <a href="../../12/10/my_books.html">My Readings …</a></li>
            <li class="right"><a href="../../08/01/adding_mongodb_event_store.html">Adding a persistent event store</a> &raquo; </li>
        </ul></article><aside class="sidebar"><section><div class="widget">
    <h1>Recent Posts</h1>
    <ul><li>
            <a href="../../../2013/08/28/setting-up-rhino-servicebus-with-rhinoqueues.html">Setting up Rhino Servicebus with Rhinoqueues</a>
        </li><li>
            <a href="../../../2013/03/27/passing_build_properties_to_psake_cmd.html">Passing build properties to psake.cmd</a>
        </li><li>
            <a href="../../../2013/03/04/custom_editor_using_twitter_bootstrap_mvc4.html">Custom editor using Twitter.Bootstrap.Mvc4</a>
        </li><li>
            <a href="../../12/10/my_books.html">My Readings …</a>
        </li><li>
            <a href="#">Continuous Integration with Jenkins, git and psake</a>
        </li><li>
            <a href="../../08/01/adding_mongodb_event_store.html">Adding a persistent event store</a>
        </li><li>
            <a href="../../07/30/protecting_entity_invariants.html">Protecting Entity Invariants</a>
        </li><li>
            <a href="../../07/27/command_validation.html">Command Validation</a>
        </li><li>
            <a href="../../07/25/extending_greg_young_s_simplest_possible_thing.html">Extending Greg Young’s Simplest Possible Thing</a>
        </li><li>
            <a href="../../07/20/cqrs_resources.html">CQRS Resources</a>
        </li></ul>
</div>
</section><section><div class="widget" id="searchbox" role="search">
    <h1><a href="#searchbox">Search</a></h1>
    <form action="../../../search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="fa fa-search"></span></button>
    </form>
</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo"><footer class="wrapper">&copy; Copyright 2010, 2011, 2012 Marijn van der Zee. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- footer-container -->

      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>